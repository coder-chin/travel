# 记一次实战经历<去哪儿网> vue-cli 2

## 基本常识

### 1.Git命令：

git add .  放到缓冲区

git commit -m 把缓冲区代码提交到本地仓库中

git push 推到远程仓库

git checkout `branchName` 切换到某分支

git merge origin/index-swiper 将分支合并到主分支

### 2.在style中引入css文件

如果需要**在style中**引入其他的css 文件，则需要使用@import 'path'

如果要用到@(也就是src),则需要在@前面加~,也就是~@

### 3.起别名

在`build/webpack.base.config.js`中resolve的alias修改，**修改以后需要重启服务器**

### 4.开发者工具可以模拟3G网络

network -> no throtting

### 5.宽高比一定

两种办法  1.height:0   padding-bottom: 50%  表示占宽度的50%

2.  width:100%  height:50%vw  视口宽度的50%

### 6.使用axios

【补充】：cdn引入axios `<script src="https://cdn.jsdelivr.net/npm/axios@0.12.0/dist/axios.min.js"></script>`

import axios from 'axios'

在声明周期钩子函数中调用函数

```javascript
methods: {
    getCityInfo() {
      axios.get('/api/city.json')
      .then(this.handleGetCityInfoSucc)
    },
    
    handleGetCityInfoSucc (res) {
      res = res.data
      if(res.ret && res.data){
        const data = res.data
        this.cities = data.cities
        this.hotCities = data.hotCities
      }
    }
 }
```

### 7.监听器watch

watch和data、methods、components是并列的，对应的是一个对象类型，对象中是函数，这些函数用于监听数据的改变。函数名就是变量名

```javascript
watch:{
    question([newValue, oldValue]){
        //code
    }
}
```

[vue官网侦听器](https://cn.vuejs.org/v2/guide/computed.html#%E4%BE%A6%E5%90%AC%E5%99%A8)

### 8.indexOf()

string.indexOf(searchvalue[,formindex])该方法用来判断字符串中是否含有特定子字符串。第一个参数是要查找的内容，第二个字符串是要开始查找的索引号，如果没有第二个参数默认从0开始。如果没有找到，返回-1

```javascript
<script type="text/javascript">

var str="Hello world!"
document.write(str.indexOf("Hello") + "<br />")
document.write(str.indexOf("World") + "<br />")
document.write(str.indexOf("world"))

</script>
以上代码的输出：

0
-1
6
```

[js indexOf()用法](https://blog.csdn.net/weixin_41646716/article/details/83270416?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162221193116780255264690%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=162221193116780255264690&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-1-83270416.first_rank_v2_pc_rank_v29&utm_term=js+indexOf%28%29%E7%94%A8%E6%B3%95&spm=1018.2226.3001.4187)

## 项目预热

安装node.js -> LTS  长期维护版，稳定

github

安装Vue CLI脚手架，创建项目 vue init webpack my-project

## 项目概述

项目根目录

![image-20210528222936127](记一次项目实战经历.assets/image-20210528222936127.png)

纠正：static可以存放静态文件，是外界可以直接访问的目录。

![image-20210528223229000](记一次项目实战经历.assets/image-20210528223229000.png)

重点介绍src目录，我们写的代码都保存在这个目录下assets是一些共用的静态资源，common放的是公共组件，pages放组件，router下面是路由配置文件，store下面是公共数据文件(vuex相关)，App.vue是跟实例，main.js是整个项目的入口。

![image-20210528223634762](记一次项目实战经历.assets/image-20210528223634762.png)

![image-20210528223744531](记一次项目实战经历.assets/image-20210528223744531.png)

### 项目初始化

1. 修改meta标签，禁止用户通过手指缩放（不报错表明引用正确）

   `index.html`

```html
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
```

2. 引入reset.css(重置样式表)   normalize修改程度比较小   reset.css对默认样式破坏性比较多
   `main.js`

3. 引入border.css   解决在某些手机上border宽度不一的情况
   ![image-20210528224123733](记一次项目实战经历.assets/image-20210528224123733.png)

4. 解决某些手机存在300毫秒延迟问题

   ```
   npm install fastclick --save  //安装
   import fastClick from 'fastclick' //导入
   fastClick.attach(document.body)  //使用
   ```

5. 删除无用代码，提交本地仓库

## 首页开发

### header区域开发

1. 安装stylus（可选）

```
npm install stylus --save
npm install stylus-loader --save
```

2. 创建header组件

3. 安装less(好用)

   ```
   npm install less less-loader --save-dev
   ```

   修改`build/webpack.base.config.js`

   ```javascript
   {
           test: /\.less$/i,
           loader: [
             // compiles Less to CSS
             "style-loader",
             "css-loader",
             "less-loader",
           ],
         }
   ```

   报错是版本原因，要安装低版本

   ```
   npm uninstall less-loader  //安装less-loader
   npm install less-loader@4.1.0  //指定版本
   ```

   ### 首页轮播图开发

   1. 线上建立分支index-swiper
   2. 拉取到本地  git pull
   3. 进入分支  git checkout index-swiper
   4. 安装swiper 
      `npm install vue-awesome-swiper@2.6.7 --save`
      这里使用v2.6.7老版本，可以在GitHub上找到具体使用的代码
   
   ### vue中css穿透
   
   在使用vue-awesome-swiper时，swiper组件并不属于当前组件，而我们又写了scoped，因此需要用到css穿透。
   
   less和sass无法识别>>>，因此要用到/deep/或者::v-deep  stylus可以识别>>>
   
   ### 实现文字省略功能
   
   ![image.png](记一次项目实战经历.assets/NURVM2pfv5B3ZOS.png)
   
   ```javascript
   overflow: hidden;
   white-space: nowrap;
   text-overflow: ellipsis;
   ```

## 城市页面开发

### 创建分支city-router

在路由文件router/index.js中配置路由

router-link把内容包裹起来，router-link实质就是a标签。  to="path"表示跳转的路径

a标签优先级高，因为浏览器对a标签有默认样式，所以a标签不会继承父类的样式

### 头部开发

### 头部搜索框

### 列表布局

分支city-list

最外层容器top,left,right,bottom都为0

overflow:hidden

#### better-scroll

```
npm install better-scroll --save
```

按照固定的结构来书写

用ref来获取DOM

import Bscroll from 'better-scroll'

this.scroll = new Bscroll(this.$refs.wrapper)

页面可以丝滑地滚动

### 页面的动态渲染

分支city-ajax

### 兄弟组件间联动

分支city-components

点击Alphabet组件中的字母，list组件通过事件对象将字母传给父组件city，city再传给list

利用better-scroll的功能自动滚到某个区域中，通过href获取dom



@touchstart

性能优化

节流

## 详情页面开发

